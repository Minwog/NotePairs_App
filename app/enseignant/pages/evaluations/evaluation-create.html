<div id="page-wrapper">


    <div class="row">
        <div class="col-lg-12">
            <h1 class="page-header">Créer une évaluation</h1>
        </div>
        <!-- /.col-lg-12 -->
    </div>
    <!-- /.row -->

    <ul class="nav nav-pills" id="myTab">
        <!-- <ul class="nav nav-pills" id="myTab"> -->
        <li class="active"><a data-toggle="tab" data-target="#menu01">Étape 1/3</a></li>
        <li><a data-toggle="tab" data-target="#menu02">Étape 2/3</a></li>
        <li><a data-toggle="tab" data-target="#menu03">Étape 3/3</a></li>
    </ul>

    <div class="tab-content" id="myTabContent">


        <div id="menu01" class="tab-pane fade active in">

            <div class="row">
                <br><br>

                <!-- modified -->
                <div class="col-lg-12">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            Cours
                        </div>
                        <!-- /.panel-heading -->
                        <div class="panel-body">
                            <div>
                                <div class="dropdown">
                                    <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                                        <span class="hidden-xl">Liste des cours</span>
                                        <span class="caret"></span>
                                    </button>
                                    <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
                                        <li ng-repeat="c in enseignant.cours track by $index"><a href="">{{c}}</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <!-- /.panel-body -->
                    </div>
                    <!-- /.panel -->

                    <div class="panel panel-default">
                        <div class="panel-heading">
                            Mode d'évaluation
                        </div>

                        <!-- /.panel-heading -->
                        <div class="panel-body">

                            <input type="checkbox" name="groupe">&nbsp;Travail individuel&nbsp&nbsp&nbsp&nbsp</input>
                            <input type="checkbox" name="groupe">&nbsp;Travail de groupe</input>
                            <br><br>
                            Date limite de rendu du devoir:
                            <input type="date" name="renduDate" />
                            <br> <br>
                            Date limite de rendu d'évaluation:
                            <input type="date" name="evaluationDate" />

                            <br><br>

                            <script type="text/javascript">
                                $(document).ready(function(){
                                    $('[data-toggle="popover"]').popover({
                                        placement : 'top',
                                        trigger : 'hover'
                                    });
                                });
                            </script>

                            Type de rendu:
                            <input type="checkbox" name="rendu">&nbsp;A la volée <span class="glyphicon glyphicon-info-sign" data-toggle="popover" title="A la volée" data-content="L'élève peut corriger les copies des autres après avoir rendu la sienne."></span> &nbsp&nbsp </input>
                            <input type="checkbox" name="rendu">&nbsp;Par étape <span class="glyphicon glyphicon-info-sign" data-toggle="popover" title="Par étape" data-content="L'élève peut corriger les copies des autres uniquement après la date limite de rendu des copies."></span></input>
                        </div>
                    </div>
                    <!-- /.panel-body -->

                    <div class="panel panel-default">
                        <div class="panel-heading">
                            Attribution des évaluations
                        </div>

                        <!-- /.panel-heading -->
                        <div class="panel-body">

                            <div class="btn-group">
                                <div class="dropdown">
                                    <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu2" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                                        <span class="hidden-xl">2 évaluations par copies</span>
                                        <span class="caret"></span>
                                    </button>
                                    <ul class="dropdown-menu" aria-labelledby="dropdownMenu2" role="menu">
                                        <li ng-repeat="i in [2,3,4,5,6,7,8,9,10]"><a href="">{{i}} évaluations par élève</a></li>
                                    </ul>
                                </div>
                            </div>
                            <br> <br>
                            Auto-évaluation:
                            <input type="checkbox" name="auto">&nbsp;Non&nbsp;</input>
                            <input type="checkbox" name="auto">&nbsp;Facultative&nbsp;</input>
                            <input type="checkbox" name="auto">&nbsp;Obligatoire&nbsp;</input>
                            <br><br>
                            <input type="checkbox" name="anonymatEleve">&nbsp;Anonymat de l'élève évalué&nbsp</input>
                            <input type="checkbox" name="anonymatEvaluateur">&nbsp;Anonymat de l'élève évaluateur</input>

                        </div>
                    </div>
                    <input type="submit" class="btn btn-primary pull-right" ui-sref=".etape2" />
                    <!-- /.panel-body -->
                </div>

            </div>
        <!-- /.row -->
        </div>





        <div id="menu02" class="tab-pane fade">


            <div class="row">
                <br><br>

                <div class="panel panel-default">
                    <div class="panel-heading">
                        Mon évaluation
                    </div>
                    <!-- /.panel-heading -->
                    <div class="panel-body">
                        <div ng-repeat="section in sectionList | orderBy : 'ordre'">

                            <div class="panel {{panelColor[($id)%4]}}">
                                <div class="panel-heading">
                                    {{section.ordre+"- "+section.titre}}
                                    <a class="btn btn-danger btn-circle-micro pull-right" data-toggle="modal" data-target="#modalDeleteSection"><i class="fa fa-times"></i>
                                    </a>
                                    <a class="btn btn-primary btn-circle-micro pull-right" href="javascript:$('#myModal .modal-body').load('remote.html',function(e){$('#myModal').modal('show');});"><i class="fa fa-list"></i>
                                    </a>
                                    <a class="btn btn-success btn-circle-micro pull-right" ng-click="sectionUp(section.ordre, sectionList)"><i class="fa fa-angle-up"></i>
                                    </a>
                                    <a class="btn btn-success btn-circle-micro pull-right" ng-click="sectionDown(section.ordre, sectionList)"><i class="fa fa-angle-down"></i>
                                    </a>
                                </div>
                                <!-- /.panel-heading -->
                                <div class="panel-body">
                                    <h4>Type de rendu : </h4>{{section.type_rendu}} &nbsp;{{section.extension}}
                                    <br><br>
                                    <h4>Contenu:</h4>
                                    {{section.enonce}}
                                    <br><br>
                                    <h4>Critères d'évaluation:</h4>
                                    <div class="table-responsive">
                                        <table id="table" class="table table-striped table-bordered table-hover">
                                            <thead>
                                            <tr><th></th><th class="index">#</th><th>Type</th></tr>
                                            </thead>
                                            <tbody>
                                            <tr ng-repeat-start="critere in section.criteres">
                                                <td>
                                                    <button ng-if="critere.expanded" ng-click="critere.expanded = false">&Hat;</button>
                                                    <button ng-if="!critere.expanded" ng-click="critere.expanded = true">+</button>
                                                </td>
                                                <td class="index">{{critere.ordre}}</td>
                                                <td>{{critere.type}}</td>

                                            </tr>

                                            <tr ng-if="critere.expanded" ng-repeat-end="">
                                                <td colspan="99">
                                                    <p>Description: {{critere.description}}</p>
                                                    <p ng-show="critere.type!='commentaire'">Nombre de points: {{critere.points}}</p>
                                                    <p ng-show="critere.type=='jugement'">Précision : {{critere.precision}}</p>
                                                    <p>
                                                    <div class="panel panel-default" ng-controller="HighChartsController">
                                                        <div class="panel-heading">
                                                            Trapèze des notes
                                                        </div>
                                                        <!-- /.panel-heading -->
                                                        <div class="panel-body">

                                                            <div id="container" style="height: 400px"></div>
                                                            <div id="drag"></div>
                                                            <div id="drop"></div>
                                                        </div>
                                                    </div>
                                                    </p>
                                                </td>
                                            </tr>

                                            </tbody>
                                        </table>
                                    </div>


                                    <script>
                                        var fixHelperModified = function(e, tr) {
                                                    var $originals = tr.children();
                                                    var $helper = tr.clone();
                                                    $helper.children().each(function(index) {
                                                        $(this).width($originals.eq(index).width())
                                                    });
                                                    return $helper;
                                                },
                                                updateIndex = function(e, ui) {
                                                    $('td.index', ui.item.parent()).each(function (i) {
                                                        $(this).html(i + 1);
                                                    });
                                                };

                                        $("#table tbody").sortable({
                                            helper: fixHelperModified,
                                            stop: updateIndex
                                        }).disableSelection();
                                    </script>
                                    <br><br>
                                    <button class="btn btn-primary" data-toggle="modal" data-target="#{{section.id}}">Ajouter un critère d'évaluation</button>



                                    <div id="{{section.id}}" class="modal fade" role="dialog">
                                        <div class="modal-dialog centered">
                                            <div class="modal-header">
                                                <button type="button" class="close" data-dismiss="modal">&times;</button>
                                                <h4 class="modal-title">Ajouter un critère d'évaluation</h4>
                                            </div>
                                            <div class="modal-body">

                                                <div class="dropdown">
                                                    <button class="btn btn-default dropdown-toggle" type="button" id="dropdown-menu"
                                                            data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                                                        <span ng-if="!newCritere.type" class="hidden-xl">Type de critère</span>
                                                        <span ng-if="newCritere.type" class="hidden-xl">{{newCritere.type}}</span>
                                                        <span class="caret"></span>
                                                    </button>
                                                    <ul class="dropdown-menu" aria-labelledby="dropdownMenu1" role="menu">
                                                        <li>
                                                            <a href="" id="commentaire" ng-click="setCritereType(1); newCritere.type='commentaire'">Commentaire</a>
                                                        </li>
                                                        <li>
                                                            <a href="" id="condition" ng-click="setCritereType(2); newCritere.type='condition'">Condition</a>
                                                        </li>
                                                        <li>
                                                            <a href="" id="jugement" ng-click="setCritereType(3); newCritere.type='jugement'">Jugement</a>
                                                        </li>
                                                    </ul>
                                                </div>

                                                <div ng-show="critere==1">
                                                    <br>
                                                    Condition : <textarea ng-model=newCritere.description type="text" placeholder="Condition" />
                                                    <br><br>
                                                </div>

                                                <div ng-show="critere==2">
                                                    <br>
                                                    Condition : <textarea ng-model=newCritere.description type="text" placeholder="Condition" />
                                                    <br><br>
                                                    Nombre de points: <input type="number" ng-model=newCritere.points_max step="0.1" min="0" max="{{section.points}}"/>
                                                </div>

                                                <div ng-show="critere==3">
                                                    <br>
                                                    Description : <textarea ng-model=newCritere.description placeholder="Description" />
                                                    <br><br>
                                                    Nombre de points: <input ng-model=newCritere.points type="number" step="0.1" min="0" max="{{section.points}}"/>
                                                    <br>
                                                    Précision: <input ng-model=newCritere.precision type="number" step="0.01" min="0" max="1"/>
                                                </div>

                                            </div>
                                            <div class="modal-footer">
                                                <button type="submit" class="btn btn-default" ng-click="addCritere(section)" data-dismiss="modal">Ajouter</button>
                                                <button type="button" class="btn btn-default" data-dismiss="modal">Annuler</button>
                                            </div>
                                        </div>
                                    </div>


                                </div>
                            </div>
                        </div>
                        <button class="btn btn-primary center-block" data-toggle="modal" data-target="#myModal">Ajouter une section</button>
                        <!-- /.panel-body -->
                    </div>

                </div>
                <input type="submit" class="btn btn-primary pull-right" ui-sref="enseignant.createEvaluation.etape3" placeholder="Créer l'évaluation" />

                <!-- Modal content-->
                <div id="myModal" class="modal fade" role="dialog">
                    <div class="modal-dialog centered">

                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                            <h4 class="modal-title" ng-show="newSection.titre==null">Ajouter une section</h4>
                            <h4 class="modal-title" ng-hide="newSection.titre==''">{{newSection.titre}}</h4>
                        </div>
                        <div class="modal-body">
                            <div class="form-group">
                                <input type="text"class="form-control" ng-model=newSection.titre id="titre" placeholder="Titre de la section"/>
                                <br>
                                <div class="btn-group">

                                    <div class="dropdown">
                                        <button class="btn btn-default dropdown-toggle" type="button" id="dropdown-menu3" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                                            <span class="hidden-xl">Type de rendu</span>
                                            <span class="caret"></span>
                                        </button>
                                        <ul class="dropdown-menu" ng-model="newSection.type_rendu" aria-labelledby="dropdownMenu1" role="menu">
                                            <li>
                                                <a ng-click="setFile(false)" id="lien" href="">Lien</a>
                                            </li>
                                            <li>
                                                <a ng-click="setFile(true)" id="file" >Fichier</a>
                                            </li>
                                            <li>
                                                <a ng-click="setFile(false)" id="text" href="">Texte</a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <br>
                                <div ng-show="file" class="dropdown">
                                    <div class="btn-group">
                                        <button class="btn btn-default dropdown-toggle" id="dropdown-menu2" type="button"
                                                data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                                            <span class="hidden-xl">Extension de fichier</span>
                                            <span class="caret"></span>
                                        </button>
                                        <ul class="dropdown-menu" aria-labelledby="dropdownMenu">
                                            <li>
                                                <div ng-click="choisirExtension(false)" href="">Tous types de fichiers</div>
                                            </li>
                                            <li ng-repeat="e in extensions">
                                                <div href="">{{e}}</div>
                                            </li>
                                            <li>
                                                <div ng-click="choisirExtension(true)">Choisir une extension</div>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <br>
                                <input ng-show="choixExtension" class="dropdown" type="texte" placeholder=".pdf">
                                </input>
                                <br>
                                Nombre de points pour la section:
                                <input type="number" step="0.1" min="0" ng-model="newSection.points"/>
                                <br><br>
                                Contenu de l'évaluation :
                                <input type="file" ng-model="newSection.enonce"/>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" class="btn btn-default" data-dismiss="modal" ng-click="addSection()">Ajouter</button>
                            <button type="button" class="btn btn-default" data-dismiss="modal">Annuler</button>
                        </div>
                    </div>
                </div>


        <div id="menu03" class="tab-pane fade" ng-controller="HighChartsController">



            <title>Mode de calcul d'évaluation</title>
            <div class="row">
                <br><br>

                <div class="col-lg-12">

                    <script>
                        $('input[type="checkbox"]').on('change', function() {
                            $('input[name="' + this.name + '"]').not(this).prop('checked', false);
                        });
                    </script>

                    <div class="panel panel-default">
                        <div class="panel-heading">
                            Devoir de calibration
                        </div>
                        <div class="panel-body">
                            Ajouter un devoir de calibration (facultatif): <input type="file"/>
                            <br>
                            Objectif:
                            <br>
                            <input type="checkbox" name="calibration" id="information">&nbsp;Information&nbsp;&nbsp;</input>
                            <input type="checkbox" name="calibration" id="calibrage">&nbsp;Calibrage&nbsp;&nbsp;</input>
                            <input type="checkbox" name="calibration" id="entrainement">&nbsp;Entraînement&nbsp;&nbsp;</input>
                            <br><br>
                            <input type="checkbox" name="calibration" />&nbsp;Utilisation d'un devoir d'élève
                        </div>
                    </div>

                    <div class="panel panel-default">
                        <div class="panel-heading">
                            Mode de calcul de la note
                        </div>
                        <div class="panel-body">

                            <input type="checkbox" name="calcul" id="moyenne">&nbsp;Moyenne des notes&nbsp;&nbsp;</input>
                            <input type="checkbox" name="calcul" id="mediane">&nbsp;Médiane des notes&nbsp;&nbsp;</input>
                            <input type="checkbox" name="calculPondere" id="ponderees">&nbsp;Evaluations pondérées&nbsp;&nbsp;</input>
                            <input type="checkbox" name="calculCalibre" id="calibrees">&nbsp;Evaluations calibrées&nbsp;&nbsp;</input>
                            <input type="checkbox" name="calculAuto" id="autoEval" ng-show="evaluation.autoEval!=0">&nbsp;Auto-évaluation prise en compte&nbsp;&nbsp;</input>
                        </div>
                    </div>

                    <div class="panel panel-default">
                        <div class="panel-heading">
                            Mode de calcul de la fiabilité
                        </div>
                        <div class="panel-body">

                        </div>
                    </div>

                    <div class="panel panel-default" ng-show="evaluation.attributionSupervisee">
                        <div class="panel-heading">
                            Superviser l'attribution des copies
                        </div>
                        <div class="panel-body">
                            <button class="btn btn-primary center-block" data-toggle="modal" data-target="#myModal">Choisir l'attribution des copies</button>
                        </div>
                    </div>
                </div>
            </div>
            <input type="submit" class="btn btn-primary pull-right" ui-sref="enseignant.createEvaluation.etape5" placeholder="Créer l'évaluation" />

        </div>
    </div>
</div>
        </div>
    </div>